# Calorie Clash — じゃんけんバトル デザインドキュメント

- 目的: じゃんけんによりラウンド結果を決定し、スコアを加算する対戦フェーズ。
- プロトタイプ: [docs/html/calorie_clash_janken_battle_battle.html](html/calorie_clash_janken_battle_battle.html)

## 画面構成
- 選択リスト: `グー/チョキ/パー` のカード（絵文字＋ラベル）。`role=listbox/option`。
- 確認モーダル: 「これで戦う？」選択内容の確認、`やめる/戦う`。
- ステージ: コール＆レスポンス（ジャン/ケン/ポン）表示、左右に手を表示するアリーナ、`VS`。
- リザルト: `WIN/LOSE/DRAW` と日本語サブテキスト、`もう一度/戻る`。
- HUD: スコアボード（You/CPU）。
- 付加演出: 画面フラッシュ、スコア増分のフロート表示。

## 操作
- キーボード: `←/→` で選択移動、`Enter` で確定、`Esc` で取り消し。
- マウス/タッチ: カードタップで選択、モーダルのボタン操作。

## ロジック概要
- 定義: `CHOICES`（絵文字/名称）と `WINS`（勝ち関係）。
- 選択: プレイヤーのキー/クリックで `selected` を更新し確認モーダルへ。
- 対戦: CPUはランダムで手を選択。ジャン→ケン→ポンの順にアニメーション表示後、勝敗判定。
- スコア: 勝ちでプレイヤー+1、負けでCPU+1、引き分けは増分なし。増分はHUD付近にアニメ表示。
- 進行: リザルト表示後、`もう一度` で再度選択フローへ、`戻る` でタイトル等へ戻る（モック）。

## レスポンシブ
- ビューポート幅/縦横比に応じてカード最小幅、アリーナ高さ、ステージパディングを調整。
- 720px以下 or 4:5以下では縦並び表示に最適化。

## アクセシビリティ
- 選択リストに `role`/`aria` を付与、カードは `:focus-visible` で可視化。
- ステージは `aria-live="polite"`/`aria-atomic` で進行文言を伝達。

## 実装メモ
- 依存: Anime.js（CDN）。
- 入力管理: `canInteract` で多重操作を抑制、`focusIdx` でキーボードフォーカスを循環。
- 小要素: フラッシュオーバーレイ、HUDのグラスモーフィズム、タッチ操作の `touch-action`。

